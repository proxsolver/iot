# System Architecture Diagrams

## 1. High-Level System Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Multi-Sensor IoT System                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌──────────────┐     Serial      ┌──────────────┐     Serial      ┌──────┐│
│  │              │   (UART @115200)│              │   (UART @115200)│      ││
│  │   Nicla      │ ──────────────> │              │ ──────────────> │      ││
│  │   Vision 1   │   Detection    │              │   Sensor       │      ││
│  │   (Zone A)   │   Events       │              │   Data         │      ││
│  │              │                │              │                │      ││
│  │  • Camera    │                │  MKR WAN     │                │      ││
│  │  • Object    │                │  1310        │                │      ││
│  │    Detection │                │              │                │      ││
│  │  • LED Alarm │                │  • Aggregates│                │      ││
│  │              │                │    Data      │                │      ││
│  └──────────────┘                │  • LoRa TX   │                │      ││
│                                  │  • WiFi OTA  │                │      ││
│  ┌──────────────┐                │              │                │      ││
│  │              │                │              │                │      ││
│  │   Nicla      │ ──────────────> │              │                │      ││
│  │   Vision 2   │   Detection    │              │                │      ││
│  │   (Zone B)   │   Events       │              │                │      ││
│  │              │                │              │                │      ││
│  │  • Camera    │                │              │                │      ││
│  │  • Object    │                │              │                │      ││
│  │    Detection │                │              │                │      ││
│  │  • LED Alarm │                │              │                │      ││
│  │              │                │              │                │      ││
│  └──────────────┘                └──────────────┘                └──────┘│
│                                                                             │
│                                             │                               │
│                                             │ LoRaWAN                       │
│                                             │ (Long-range, low-power)       │
│                                             ▼                               │
│                                  ┌──────────────────┐                       │
│                                  │  LoRa Gateway    │                       │
│                                  │  (TTN/Private)   │                       │
│                                  └──────────────────┘                       │
│                                             │                               │
│                                             │ Internet/MQTT                 │
│                                             ▼                               │
│                                  ┌──────────────────┐                       │
│                                  │  Cloud/Local     │                       │
│                                  │  Dashboard       │                       │
│                                  └──────────────────┘                       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 2. Component Interaction Diagram

```
                        Data Flow & Communication Protocol

┌────────────────────────────────────────────────────────────────────────────┐
│                           Local Communication Layer                        │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   ┌──────────────┐                                                    ┌────┴─┐
│   │ Nicla Vision │ TX ────────────────────────────────────────────> │ RX   │
│   │      1       │  (JSON: detection events, confidence, bbox)       │      │
│   └──────────────┘                                                │ MKR  │
│                                                                   │ WAN  │
│   ┌──────────────┐                                              │ 1310 │
│   │ Nicla Vision │ TX ──────────────────────────────────────────> │      │
│   │      2       │  (JSON: detection events, confidence, bbox)       │ RX   │
│   └──────────────┘                                                └──────┘
│                                                                            │
│   ┌──────────────┐                                                    ┌────┐
│   │ Nicla Sense  │ TX ─────────────────────────────────────────────> │ RX │
│   │     Me       │  (JSON: temperature, humidity, pressure, gas)     │    │
│   └──────────────┘                                                └────┘
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘

                         Long-Range Communication Layer

┌────────────────────────────────────────────────────────────────────────────┐
│                        LoRaWAN (up to 10km range)                         │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   ┌──────────────┐                                                     ┌──┴─┐
│   │ MKR WAN 1310 │ ──── LoRa Radio (868/915 MHz) ──────────────────> │GW  │
│   │              │  • Detection count (last 5 min)                    │    │
│   │ Transmits:   │  • Last detection type                             │    │
│   │              │  • Temperature                                     │    │
│   │ • Aggregated │  • Humidity                                        │    │
│   │   sensor     │  • Battery status                                  │    │
│   │   data       │  • System health                                   │    │
│   │ • System     │                                                     │    │
│   │   status     │                                                     │    │
│   └──────────────┘                                                     └────┘
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘

                          Configuration & Update Layer

┌────────────────────────────────────────────────────────────────────────────┐
│                            WiFi (OTA Updates)                              │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│   ┌──────────────┐         WiFi Network          ┌──────────────┐         │
│   │   WiFi       │ <─────────────────────────>  │   Update     │         │
│   │   Router     │     (HTTP/HTTPS)            │   Server     │         │
│   └──────────────┘                                 └──────────────┘         │
│          ▲                                                               │
│          │                                                               │
│          │ OTA Update Request                                            │
│   ┌──────┴────┐                                                          │
│   │ MKR WAN   │                                                          │
│   │  1310     │                                                          │
│   └───────────┘                                                          │
│         • Check for updates                                               │
│         • Download firmware                                               │
│         • Verify checksum                                                  │
│         • Apply & reboot                                                  │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

## 3. Detailed Hardware Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       Detailed Hardware Architecture                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                     Nicla Vision #1 (Zone A)                        │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │   │
│  │  │   OV5640     │  │  STM32H747   │  │   RGB LED    │              │   │
│  │  │   Camera     │  │  Dual Core   │  │   (Alarm)    │              │   │
│  │  │              │  │              │  │              │              │   │
│  │  │  • 2MP       │  │  • 480MHz M7 │  │  • Red       │              │   │
│  │  │  • 480x480   │  │  • 240MHz M4 │  │  • Green     │              │   │
│  │  │  • RGB565    │  │  • 16MB Fl.  │  │  • Blue      │              │   │
│  │  └──────┬───────┘  └──────┬───────┘  └──────────────┘              │   │
│  │         │                  │                                         │   │
│  │         │ CSI Interface     │                                         │   │
│  │         └──────────────────┘                                         │   │
│  │                                                                     │   │
│  │  Software: EdgeML/TFLite, Motion Detection, Serial Comm            │   │
│  │  Power: USB or Li-Po (1400mAh)                                      │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                     Nicla Vision #2 (Zone B)                        │   │
│  │                     (Identical to #1)                               │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                       Nicla Sense Me                                 │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐            │   │
│  │  │  BME688  │  │  BMM150  │  │ nRF52840 │  │Battery   │            │   │
│  │  │          │  │  IMU     │  │          │  │Charging  │            │   │
│  │  │          │  │          │  │ 64MHz    │  │          │            │   │
│  │  │• Temp    │  │• Accel   │  │ 1MB Fl.  │  │ Li-Po    │            │   │
│  │  │• Humid   │  │• Gyro    │  │ 256KB    │  │ 500mAh   │            │   │
│  │  │• Press   │  │• Magne   │  │          │  │          │            │   │
│  │  │• Gas     │  │          │  │ BLE      │  │          │            │   │
│  │  └──────────┘  └──────────┘  └──────────┘  └──────────┘            │   │
│  │                                                                     │   │
│  │  Software: BSEC algorithm, Low Power Sleep, Serial Comm            │   │
│  │  Power: Li-Po battery with charging circuit                         │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                      MKR WAN 1310 (Hub)                             │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │   │
│  │  │  Murata      │  │  u-blox      │  │  SAMD21      │              │   │
│  │  │  ABZ LoRa    │  │  NINA-W10    │  │  Cortex-M0+  │              │   │
│  │  │              │  │              │  │              │              │   │
│  │  │  • EU868/    │  │  • WiFi      │  │  • 48MHz     │              │   │
│  │  │    US915     │  │  • 2.4GHz    │  │  • 256KB Fl. │              │   │
│  │  │  • LoRaWAN   │  │  • 802.11n   │  │  • 32KB RAM  │              │   │
│  │  │  • 14dBm TX  │  │  • OTA Cap.  │  │              │              │   │
│  │  └──────┬───────┘  └──────────────┘  └──────┬───────┘              │   │
│  │         │                                     │                      │   │
│  │         │ SPI                                 │                      │   │
│  │         └─────────────────────────────────────┘                      │   │
│  │                        │                                              │   │
│  │                        │                                              │   │
│  │  Serial Ports:  ┌──────┴──────┐                                       │   │
│  │  Serial (USB)   │  Multi-Port  │                                       │   │
│  │  Serial1 (IO13/14)│  UART      │                                       │   │
│  │  Serial2 (IO0/1) │  Manager    │                                       │   │
│  │                  └─────────────┘                                       │   │
│  │                                                                     │   │
│  │  Software: LoRaWAN stack, WiFi, OTA, Data Aggregation              │   │
│  │  Power: USB or Li-Po (2000mAh)                                       │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 4. Data Flow Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           Data Flow Pipeline                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  EVENT: Motion Detected in Zone A                                          │
│  ═══════════════════════════════════════                                    │
│                                                                             │
│  1. Nicla Vision #1                                                         │
│     ├─ Camera captures frame (480x480 RGB565)                              │
│     ├─ EdgeML processes image → Object detected (person, 92% conf)        │
│     ├─ Trigger local alarm (RGB LED: Red flash)                            │
│     └─ Create JSON message:                                                │
│        {                                                                   │
│          "source": "vision_1",                                             │
│          "timestamp": 1234567890,                                          │
│          "detection": {                                                    │
│            "class": "person",                                              │
│            "confidence": 0.92,                                             │
│            "bbox": [100, 150, 200, 300]                                    │
│          },                                                                 │
│          "alarm_triggered": true                                           │
│        }                                                                   │
│                                                                             │
│  2. Serial Transmission (UART @115200)                                     │
│     └─ Nicla Vision #1 TX → MKR WAN 1310 RX (Serial1)                     │
│                                                                             │
│  3. MKR WAN 1310 Processing                                                │
│     ├─ Parse JSON message                                                  │
│     ├─ Update detection count (last 5 minutes)                             │
│     ├─ Store in buffer for LoRa transmission                               │
│     ├─ Log to Serial Monitor for debugging                                 │
│     └─ Send ACK back to Nicla Vision #1                                    │
│                                                                             │
│  4. LoRa Transmission (on 5-minute interval or immediate if critical)      │
│     ├─ Aggregate data:                                                     │
│        {                                                                   │
│          "detection_count": 3,                                             │
│          "last_detection": "person",                                       │
│          "temperature": 23.5,                                              │
│          "humidity": 65.2,                                                 │
│          "battery_level": 85                                               │
│        }                                                                   │
│     ├─ Encode to CayenneLPP (efficient binary format)                      │
│     └─ Transmit via LoRaWAN (SF7, 868MHz)                                  │
│                                                                             │
│  5. LoRa Gateway                                                           │
│     ├─ Receive radio packet (up to 10km range)                             │
│     ├─ Forward to The Things Network                                      │
│     └─ TTN processes and stores data                                       │
│                                                                             │
│  6. Cloud/Local Dashboard                                                  │
│     ├─ Subscribe to TTN MQTT topic                                         │
│     ├─ Decode CayenneLPP payload                                           │
│     ├─ Update real-time display:                                           │
│        • Detection count graph                                             │
│        • Last detection time and type                                      │
│        • Environmental data trends                                         │
│        • Battery status                                                    │
│     └─ Trigger notifications (email, SMS) on critical events               │
│                                                                             │
│  EVENT: Periodic Environmental Reading (every 5 minutes)                   │
│  ═════════════════════════════════════════════════════                    │
│                                                                             │
│  1. Nicla Sense Me                                                         │
│     ├─ Wake from deep sleep                                                │
│     ├─ Read sensors:                                                       │
│        • Temperature: 23.5°C                                               │
│        • Humidity: 65.2%                                                   │
│        • Pressure: 1013.25 hPa                                             │
│        • Gas resistance: 45000 Ω                                           │
│     └─ Create JSON message:                                                │
│        {                                                                   │
│          "source": "sense_me",                                             │
│          "timestamp": 1234567890,                                          │
│          "sensors": {                                                      │
│            "temperature": 23.5,                                            │
│            "humidity": 65.2,                                               │
│            "pressure": 1013.25,                                            │
│            "gas_resistance": 45000                                         │
│          }                                                                 │
│        }                                                                   │
│                                                                             │
│  2. Serial Transmission (UART @115200)                                     │
│     └─ Nicla Sense Me TX → MKR WAN 1310 RX (Serial2)                      │
│                                                                             │
│  3. MKR WAN 1310 Processing                                                │
│     ├─ Parse JSON message                                                  │
│     ├─ Update environmental data buffer                                    │
│     └─ Combine with detection data for LoRa transmission                   │
│                                                                             │
│  4-6. (Same LoRa → Gateway → Cloud pipeline as above)                      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 5. Power Management Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        Power Management Strategy                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                      Power States & Transitions                     │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  Nicla Vision Boards                                                │   │
│  │  ┌─────────┐     wake     ┌──────────┐    sleep     ┌──────────┐  │   │
│  │  │  DEEP   │ ──────────> │ ACTIVE   │ ──────────> │  STANDBY │  │   │
│  │  │ SLEEP   │ <────────── │          │ <───────── │          │  │   │
│  │  │  ~5mA   │   (timer/   │  ~250mA  │  (no move  │  ~50mA   │  │   │
│  │  └─────────┘   motion)   └──────────┘  30 sec)   └──────────┘  │   │
│  │       ▲                           │                              │   │
│  │       │                           │                              │   │
│  │       │              Detection    │                              │   │
│  │       └───────────────────────────┘                              │   │
│  │         (interrupt on event)                                     │   │
│  │                                                                     │   │
│  │  Nicla Sense Me                                                    │   │
│  │  ┌─────────┐     wake     ┌──────────┐    sleep     ┌──────────┐  │   │
│  │  │  DEEP   │ ──────────> │ ACTIVE   │ ──────────> │  STANDBY │  │   │
│  │  │ SLEEP   │ <────────── │          │ <───────── │          │  │   │
│  │  │  ~1mA   │   (5 min    │  ~15mA   │  (5 sec    │  ~5mA    │  │   │
│  │  └─────────┘   timer)    └──────────┘  read)     └──────────┘  │   │
│  │                                                                     │   │
│  │  MKR WAN 1310                                                      │   │
│  │  ┌─────────┐     wake     ┌──────────┐    sleep     ┌──────────┐  │   │
│  │  │  DEEP   │ ──────────> │ ACTIVE   │ ──────────> │  LIGHT   │  │   │
│  │  │ SLEEP   │ <────────── │          │ <───────── │  SLEEP   │  │   │
│  │  │ ~0.1mA  │   (incoming │  ~50mA   │  (no data  │  ~5mA    │  │   │
│  │  └─────────┘   Serial/   └──────────┘  1 min)    └──────────┘  │   │
│  │               LoRa RX)                                             │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  Battery Life Estimates (2000mAh Li-Po battery):                           │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ Operating Mode              | Current  | Battery Life                │   │
│  ├─────────────────────────────┼──────────┼───────────────────────      │   │
│  │ Continuous monitoring       | ~400mA   | ~5 hours                     │   │
│  │ Duty-cycled (5 min wake)    | ~120mA  | ~16 hours                    │   │
│  │ Optimized (1 wake/hour)     | ~80mA   | ~25 hours                    │   │
│  │ Ultra-low power (sleep)     | ~10mA   | ~8 days                      │   │
│  └─────────────────────────────┴──────────┴───────────────────────      │   │
│                                                                             │
│  Power Optimization Techniques:                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 1. Reduce frame rate on Nicla Vision (15 FPS → 5 FPS)               │   │
│  │ 2. Lower LoRa spreading factor (SF10 → SF7) when range sufficient   │   │
│  │ 3. Increase sleep intervals where possible                           │   │
│  │ 4. Use motion detection to trigger vision processing                │   │
│  │ 5. Disable unused peripherals (WiFi when not updating)              │   │
│  │ 6. Use sleep instead of delay() in all boards                        │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 6. Software Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Software Architecture                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    Nicla Vision #1 Firmware                         │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐        │   │
│  │  │   Camera       │  │  Object        │  │  Alarm         │        │   │
│  │  │   Interface    │→ │  Detection     │→ │  Controller    │        │   │
│  │  │                │  │  (EdgeML)      │  │  (LED)         │        │   │
│  │  └────────────────┘  └────────────────┘  └────────────────┘        │   │
│  │                                                         │           │   │
│  │                                                         ↓           │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐        │   │
│  │  │   Serial       │← │  Message       │← │  Event         │        │   │
│  │  │   Manager      │  │  Formatter     │  │  Queue         │        │   │
│  │  └────────────────┘  └────────────────┘  └────────────────┘        │   │
│  │                                                         │           │   │
│  │                                                         ↓           │   │
│  │  ┌────────────────┐                                               │   │
│  │  │  Power Manager │  (Sleep/Wake control)                         │   │
│  │  └────────────────┘                                               │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    Nicla Sense Me Firmware                          │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐        │   │
│  │  │   BME688       │  │   BMM150       │  │   Sensor       │        │   │
│  │  │   Driver       │→ │   IMU Driver   │→ │   Fusion       │        │   │
│  │  └────────────────┘  └────────────────┘  └────────────────┘        │   │
│  │                                                         │           │   │
│  │                                                         ↓           │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐        │   │
│  │  │   Serial       │← │  JSON          │← │  Data          │        │   │
│  │  │   Manager      │  │  Formatter     │  │  Buffer        │        │   │
│  │  └────────────────┘  └────────────────┘  └────────────────┘        │   │
│  │                                                         │           │   │
│  │                                                         ↓           │   │
│  │  ┌────────────────┐                                               │   │
│  │  │  Power Manager │  (RTC wake, deep sleep)                        │   │
│  │  └────────────────┘                                               │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    MKR WAN 1310 Firmware                            │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐        │   │
│  │  │  Serial1       │  │  Serial2       │  │  Serial (USB)  │        │   │
│  │  │  (Vision #1)   │  │  (Sense Me)    │  │  (Debug)       │        │   │
│  │  └───────┬────────┘  └───────┬────────┘  └────────┬───────┘        │   │
│  │          │                   │                    │                 │   │
│  │          └─────────┬─────────┘                    │                 │   │
│  │                    ↓                             │                 │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌──────┴───────┐        │   │
│  │  │  JSON          │  │  Data          │  │  Debug       │        │   │
│  │  │  Parser        │→ │  Aggregator    │  │  Logger      │        │   │
│  │  └────────────────┘  └───────┬────────┘  └──────────────┘        │   │
│  │                              │                                     │   │
│  │                              ↓                                     │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐        │   │
│  │  │  LoRaWAN       │  │  WiFi          │  │  Watchdog     │        │   │
│  │  │  Stack         │  │  Manager       │  │  Timer        │        │   │
│  │  └────────────────┘  └────────────────┘  └────────────────┘        │   │
│  │         │                   │                                     │   │
│  │         ↓                   ↓                                     │   │
│  │  ┌────────────────┐  ┌────────────────┐                          │   │
│  │  │  LoRa TX/RX    │  │  OTA Update    │                          │   │
│  │  └────────────────┘  └────────────────┘                          │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    Cloud/Local Dashboard                            │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                     │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐        │   │
│  │  │  MQTT          │  │  Data          │  │  Web UI        │        │   │
│  │  │  Subscriber    │→ │  Processor     │→ │  (React/Vue)   │        │   │
│  │  └────────────────┘  └────────────────┘  └────────────────┘        │   │
│  │                                                         │           │   │
│  │                                                         ↓           │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐        │   │
│  │  │  Database      │  │  Alert         │  │  User          │        │   │
│  │  │  (InfluxDB)    │  │  Manager       │  │  Auth          │        │   │
│  │  └────────────────┘  └────────────────┘  └────────────────┘        │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 7. Network Topology

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          Network Topology                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                              Local Network                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                     │   │
│  │   ┌─────────┐         ┌─────────┐         ┌─────────┐              │   │
│  │   │Nicla    │ Serial  │  MKR    │ Serial  │Nicla    │              │   │
│  │   │Vision 1 │<───────>│  WAN    │<───────>│Vision 2 │              │   │
│  │   └─────────┘  115200 │  1310   │ 115200  └─────────┘              │   │
│  │        ↑                   └─────────┘           ↑                  │   │
│  │        │                         │               │                  │   │
│  │        │                         │               │                  │   │
│  │   Zone A Monitoring         Central Hub      Zone B Monitoring      │   │
│  │   (e.g., Entrance)         (Data Aggregation) (e.g., Perimeter)    │   │
│  │                                                                     │   │
│  │   ┌─────────┐                                                │   │
│  │   │Nicla    │ Serial                                        │   │
│  │   │Sense Me │<───────                                       │   │
│  │   └─────────┘  115200                                       │   │
│  │        ↑                                                      │   │
│  │   Environmental Monitoring                                    │   │
│  │   (Temperature, Humidity, Pressure)                           │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│                              Wide Area Network                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                     │   │
│  │   ┌─────────┐                                                      │   │
│  │   │  MKR    │                                                      │   │
│  │   │  WAN    │ ──── LoRaWAN Radio (868/915 MHz) ──> ┌──────────┐   │   │
│  │   │  1310   │                                                 │   │   │
│  │   └─────────┘                                                 │   │   │
│  │                                                               │GW │   │
│  │                                    ┌─────────┐              └────┘   │   │
│  │                                    │ Internet │                      │   │
│  │   ┌──────────┐          ┌─────────>│ (Cloud)  │                       │   │
│  │   │TTN/Other │<─────────┘          └─────────┘                       │   │
│  │   │Server    │                                                       │   │
│  │   └─────┬────┘                                                       │   │
│  │         │                                                            │   │
│  │         │ MQTT/WebSocket                                            │   │
│  │         ↓                                                            │   │
│  │   ┌──────────────┐                                                   │   │
│  │   │  Dashboard   │                                                   │   │
│  │   │  (Web UI)    │                                                   │   │
│  │   └──────────────┘                                                   │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  WiFi Network (OTA Updates)                                                │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                     │   │
│  │   ┌─────────┐                                                     │   │
│  │   │  WiFi   │                                                     │   │
│  │   │ Router  │<─────── WiFi (2.4GHz)                              │   │
│  │   └────┬────┘         │                                           │   │
│  │        │             │                                           │   │
│  │        │             ↓                                           │   │
│  │        │      ┌─────────┐                                        │   │
│  │        │      │  MKR    │                                        │   │
│  │        │      │  WAN    │                                        │   │
│  │        │      │  1310   │                                        │   │
│  │        │      └────┬────┘                                        │   │
│  │        │           │                                             │   │
│  │        │           │ OTA Updates (HTTPS/HTTP)                     │   │
│  │        │           ↓                                             │   │
│  │        │    ┌──────────────┐                                     │   │
│  │        └───>│  Update      │                                     │   │
│  │             │  Server      │                                     │   │
│  │             │  (Arduino    │                                     │   │
│  │             │   Cloud)     │                                     │   │
│  │             └──────────────┘                                     │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```
